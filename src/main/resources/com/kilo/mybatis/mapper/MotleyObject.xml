<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.kilo.dao.mybatis.mapper.Motley">

    <insert id="createStageTable" parameterType="java.util.Map">
      create table ${stageTableName}
      (date DATETIME, name VARCHAR(100), id INT, price INT, amount INT, fx_rate INT, is_valid BIT, knowledge_time DATETIME)
    </insert>
    
    <insert id="insertStage" parameterType="java.util.Map">
        INSERT INTO ${stageTableName}(date, name, id, price, amount, fx_rate, is_valid, knowledge_time)
        VALUES (#{rec.date}, #{rec.name}, #{rec.id}, #{rec.price}, #{rec.amount},
                #{rec.fxRate}, #{rec.isValid}, #{rec.knowledgeTime})
    </insert>

    <delete id="insertStageDrop" parameterType="java.util.Map">
        DROP TABLE ${stageTableName}
    </delete>

    <insert id="bulkInsertStage" parameterType="java.util.Map">
        BULK INSERT ${stageTableName}
               FROM '${fileUNCPath}'
    </insert>

    <insert id="insertStats" parameterType="java.util.Map">
        INSERT INTO sandbox.guest.run_stats (runID , runType , success , startTime , endTime, timeTaken, tableCreation , tableDrop , network , dbInner , others )
          VALUES (#{runID}, #{runType}, #{success}, #{startTime}, #{endTime},#{timeTaken}, #{tableCreation} , #{tableDrop} , #{network} , #{dbInner} ,#{others})
    </insert>

</mapper>